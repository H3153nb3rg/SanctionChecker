<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">


    <!--                          -->
   <!-- Stream Definition SEPA  -->
   <!--                          -->
   
	<bean id="StreamConfigSEPA" class="at.jps.sanction.domain.payment.StreamConfig" scope="singleton" lazy-init="true">
	
			<!-- fields & fuzziness -->
		
		<property name="minTokenLen" value="2"/>
		<property name="minRelVal" value="79"/>
		<property name="minAbsVal" value="60"/>		
		<property name="fuzzyVal" value="20"/>		
		
		<property name="checkFields" value="/Nm,/Ctry,/IBAN,/BIC,/AdrLine"/>		
		<property name="BICFields" value="/BIC"/>		
		<property name="fuzzyFields" value="/Nm,/AdrLine"/>		
		
	</bean>

   
   <bean id="StreamManagerSEPA" class="at.jps.sanction.domain.payment.PaymentStreamManager" init-method="initialize" destroy-method="close" scope="singleton" lazy-init="true">

		<property name="streamName" value="SEPA"/>
		
		<property name="streamConfig">
			<ref bean="StreamConfigSEPA"/>
		</property>
   
		<property name="purgeQueuesOnStartup" value="true"/>
   
		<!-- workers counters -->
		
		<property name="nrWorkersInput" value="1"/>
		<property name="nrWorkersOutputHit" value="0"/>
		<property name="nrWorkersOutputNoHit" value="0"/>
		<property name="nrWorkersError" value="1"/>
		<property name="nrWorkersChecker" value="4"/>
		<property name="nrWorkersPostHit" value="1"/>
		<property name="nrWorkersPostNoHit" value="1"/>
				
		<!-- used queues -->
				
		<property name="inputQueue" >
			<ref bean="InputQueueFile"/>
		</property>
		
		<property name="defectQueue" >
			<ref bean="DefectQueueFile"/>
		</property>
		
		<property name="hitQueue" >
			<ref bean="HitQueueFile"/>
		</property>
		
		<property name="noHitQueue" >
			<ref bean="NoHitQueueFile"/>
		</property>
		
		<property name="postProcessHitQueue" >
			<ref bean="PostHitQueueFile"/>
		</property>
		
		<property name="postProcessNoHitQueue" >
			<ref bean="PostNoHitQueueFile"/>
		</property>

		<property name="txNoHitOptimizationListHandler" >   
   			<ref bean="OptiNoHitList"/>
		</property>
		
		<property name="txHitOptimizationListHandler" >   
   			<ref bean="OptiHitList"/>
		</property>
						
		<property name="noWordHitListHandler" >   
   			<ref bean="NoWordHitList"/>
		</property>
		
	</bean>

   <!-- workers -->
   
	<bean id="InputProcessor" class="at.jps.sanction.core.io.file.FileInputWorker" init-method="initialize" destroy-method="close" scope="prototype">
		<property name="path" value="C:\temp\SanctionTest\in\sepa"/>
		<property name="pattern" value="*.xml"/>
		<property name="sleepMillisBetween" value="10000"/>
		
		<property name="fileParser" >
			<ref bean="FileParser"/>
		</property>
	</bean>
	
	<bean id="FileParser" class="at.jps.sanction.domain.payment.sepa.SepaFileParser" scope="prototype">
	    
	    <property name="streamManager" >		    
		    	<ref bean="StreamManagerSEPA"/>    		    
		</property>
	    
	</bean>
	
	<bean id="OutputProcessor" class="at.jps.sanction.core.io.file.FileOutputWorker" init-method="initialize" destroy-method="close" scope="prototype">
				
		<property name="path" value="C:\temp\SanctionTest\out\sepa"/>
		<property name="sleepMillisBetween" value="0"/>
		
	</bean>
	
	<bean id="ErrorProcessor" class="at.jps.sanction.core.io.file.FileOutputWorker" init-method="initialize" destroy-method="close" scope="prototype">
		<!-- property name="filename" value="C:\\temp\\SanctionTest\\out\\swift\outfile.txt"/ -->		
		<property name="path" value="C:\temp\SanctionTest\out\sepa"/>
		<property name="sleepMillisBetween" value="0"/>
		</bean>
	
	<bean id="PostProcessorHit" class="at.jps.sanction.domain.payment.sepa.worker.SepaPostHitWorker" init-method="initialize" destroy-method="close" scope="prototype">
	</bean>
	
	<bean id="PostProcessorNoHit" class="at.jps.sanction.domain.payment.sepa.worker.SepaPostNoHitWorker" init-method="initialize" destroy-method="close" scope="prototype">
	</bean>
				
	<!-- bean id="MessageParser" class="at.jps.sanction.core.io.file.FileInputWorker" init-method="initialize" destroy-method="close" scope="prototype">
	</bean -->
	
	<bean id="MessageAnalyser" class="at.jps.sanction.domain.payment.sepa.SepaAnalyzer" init-method="initialize" destroy-method="close" scope="prototype">
		<property name="sleepMillisBetween" value="100"/>
		<property name="messageTypes">
		    <list>
		        <value>pacs.008</value>
		        <value>pacs.003</value>
		    </list>
		</property>
	</bean>

</beans>	